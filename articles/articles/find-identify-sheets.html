<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Find and identify Sheets • googlesheets4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../tidyverse-2.css" rel="stylesheet">
<!--optional theme--><link href="../../.css" rel="stylesheet">
<meta property="og:title" content="Find and identify Sheets">
<meta property="og:description" content="googlesheets4">
<meta property="og:image" content="https://googlesheets4.tidyverse.org/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../../index.html">googlesheets4</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../articles/googlesheets4.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/read-sheets.html">Read Sheets</a>
    </li>
    <li>
      <a href="../../articles/articles/write-sheets.html">Write Sheets</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Special topics</li>
    <li>
      <a href="../../articles/articles/auth.html">googlesheets4 auth</a>
    </li>
    <li>
      <a href="../../articles/articles/dates-and-times.html">Dates and times</a>
    </li>
    <li>
      <a href="../../articles/articles/find-identify-sheets.html">Find and identify Sheets</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Connections to other packages</li>
    <li>
      <a href="../../articles/articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>
    </li>
    <li>
      <a href="../../articles/articles/fun-with-googledrive-and-readxl.html">Fun with googledrive and readxl</a>
    </li>
    <li>
      <a href="../../articles/articles/googlesheets4-reprex.html">How to create a googlesheets4 reprex</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Blog posts</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/">googlesheets4 0.2.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/googlesheets4/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="find-identify-sheets_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="find-identify-sheets_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="find-identify-sheets_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Find and identify Sheets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/googlesheets4/blob/master/vignettes/articles/find-identify-sheets.Rmd"><code>vignettes/articles/find-identify-sheets.Rmd</code></a></small>
      <div class="hidden name"><code>find-identify-sheets.Rmd</code></div>

    </div>

    
    
<pre><code>No token available. Code chunks will not be evaluated.</code></pre>
<p>There are many ways to get your hands on your Sheets, in order to work with them via googlesheets4. They basically range from “ugly, but low effort” to “more humane, but more effort”.</p>
<div id="attach-googlesheets4" class="section level2">
<h2 class="hasAnchor">
<a href="#attach-googlesheets4" class="anchor"></a>Attach googlesheets4</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/googlesheets4">googlesheets4</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="auth" class="section level2">
<h2 class="hasAnchor">
<a href="#auth" class="anchor"></a>Auth</h2>
<p>As a regular, interactive user, you can just let googlesheets4 prompt you for anything it needs re: auth.</p>
<p>Since this article is compiled noninteractively on a server, we have arranged for googlesheets4 to use a service account token (not shown).</p>
</div>
<div id="use-a-url" class="section level2">
<h2 class="hasAnchor">
<a href="#use-a-url" class="anchor"></a>Use a URL</h2>
<p>When you visit a Sheet in the browser, you can copy that URL to your clipboard. Such URLs look something like this:</p>
<pre><code>https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077</code></pre>
<p>which breaks down like this:</p>
<pre><code>https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit#gid=SHEET_ID</code></pre>
<p>Notice that this URL contains a (spread)Sheet ID and a (work)sheet ID. This URL happens to link to <a href="https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077">the official example Sheet that holds Gapminder data</a>.</p>
<p>googlesheets4 accepts such a URL as the <code>ss</code> argument (think “spreadsheet”) of many functions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ugly_url</span> <span class="op">&lt;-</span> <span class="st">"https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077"</span>
<span class="fu"><a href="../../reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">ugly_url</span><span class="op">)</span></code></pre></div>
<p>At this time, although the URL may contain both a (spread)Sheet and a (work)sheet, we only extract the (spread)Sheet ID. If the function targets a specific (work)sheet, that is typically specified via arguments like <code>range</code> or <code>sheet</code> or a default of “first (visible) sheet”.</p>
<p>These URLs are not particularly nice to look at in your code, though.</p>
</div>
<div id="use-a-sheet-id" class="section level2">
<h2 class="hasAnchor">
<a href="#use-a-sheet-id" class="anchor"></a>Use a Sheet ID</h2>
<p>You can extract the Sheet ID from a URL with <code><a href="../../reference/as_sheets_id.html">as_sheets_id()</a></code> (which is what we are doing internally to make the URL work in the first place):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ssid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/as_sheets_id.html">as_sheets_id</a></span><span class="op">(</span><span class="va">ugly_url</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span></code></pre></div>
<p><code><a href="../../reference/as_sheets_id.html">as_sheets_id()</a></code> is a generic function, which means it knows what to do with a few different types of input. For character string input, <code><a href="../../reference/as_sheets_id.html">as_sheets_id()</a></code> passes a string through, unless it looks like a URL. If it looks like a URL, we use a regular expression to extract the Sheet ID. The returned string bears the classes <code>sheets_id</code> and <code>drive_id</code> (for playing nicely with googledrive).</p>
<p>Why did we call <code><a href="https://rdrr.io/r/base/class.html">unclass(ssid)</a></code> above to see the naked Sheet ID? Because, by default, when you print an instance of <code>sheets_id</code>, we attempt to show you some current metadata about the Sheet.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ssid</span></code></pre></div>
<p>This is the same metadata you’ll see when you call <code><a href="../../reference/gs4_get.html">gs4_get()</a></code> (but you must call <code><a href="../../reference/gs4_get.html">gs4_get()</a></code> explicitly if you want to <em>store</em> the returned metadata).</p>
<p>googlesheets4 also accepts a Sheet ID as the <code>ss</code> argument of many functions:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span></code></pre></div>
<p>I think in a script or app that will endure for a while it is better to refer to a Sheet by its ID than by its URL. The Sheet ID is nicer to look at, it is complete, it is minimal.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ssid</span> <span class="op">&lt;-</span> <span class="st">"1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY"</span>
<span class="fu"><a href="../../reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span></code></pre></div>
<p>Note this demonstration that a Sheet ID also works when provided as a plain, old string, i.e. it does not <strong>have</strong> to have the <code>sheets_id</code> class. In some contexts, you might even prefer to store it as a string, in order to bypass the special printing behaviour for <code>sheets_id</code>.</p>
<p>When the Sheet is specified via a character string, googlesheets4 assumes it is a Sheet ID (or an ID-containing URL). This is NOT the case for googledrive, which assumes a character string is a file name or path. Therefore, for maximum happiness, in a mixed googlesheets4 / googledrive workflow, it’s a good idea to be explicit and declare a string to be a Sheet ID, when that is the case.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ssid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/as_sheets_id.html">as_sheets_id</a></span><span class="op">(</span><span class="st">"1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY"</span><span class="op">)</span>
<span class="fu"><a href="../../reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">ssid</span><span class="op">)</span></code></pre></div>
<p>If your script or app targets a specific Sheet, the most efficient and robust way to address it is by its ID.</p>
</div>
<div id="use-the-sheets-name-uses-googledrive" class="section level2">
<h2 class="hasAnchor">
<a href="#use-the-sheets-name-uses-googledrive" class="anchor"></a>Use the Sheet’s name (uses googledrive)</h2>
<p>A big feature of the googledrive package is the ability to navigate between human-friendly file names and machine-friendly file IDs. Both the Drive and Sheets APIs require the use of IDs, so the illusion that you can identify a Drive file by name is provided by the googledrive package. (A Google Sheet is just a special case of a Drive file … a file that happens to be a spreadsheet.)</p>
<p>If you need to refer to a Sheet by name, i.e. if you need to lookup its file ID based on its name, you must use the googledrive package for that. There are other reasons for using these two packages together: the Sheets API has an intentionally narrow focus on spreadsheet operations involving worksheets and cells. General whole-file operations, like copy / rename / move / share, must be done via the Drive API and, within R, via googledrive. See the article <a href="https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a> for more.</p>
<p>It’s time to attach googledrive (in addition to the already-attached googlesheets4):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://googledrive.tidyverse.org">googledrive</a></span><span class="op">)</span></code></pre></div>
<p>(In our hidden auth chunk, we actually put a shared token into force for both googlesheets4 and googledrive, anticipating this moment.)</p>
<p>The Sheet we’ve been working with is named “gapminder” and is owned by the account we’ve logged in as here. We can use <code><a href="https://googledrive.tidyverse.org/reference/drive_get.html">googledrive::drive_get()</a></code> to identify a file by name:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">gap_dribble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_get.html">drive_get</a></span><span class="op">(</span><span class="st">"gapminder"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><code><a href="https://googledrive.tidyverse.org/reference/drive_get.html">drive_get()</a></code> returns a <a href="https://googledrive.tidyverse.org/reference/dribble.html"><code>dribble</code></a>, a “Drive tibble”, where each row holds info on a Drive file. <code><a href="../../reference/as_sheets_id.html">as_sheets_id()</a></code> also accepts a one-row <code>dribble</code>, so we can get right into our normal googlesheets4 workflows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gap_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/as_sheets_id.html">as_sheets_id</a></span><span class="op">(</span><span class="va">gap_dribble</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">gap_id</span><span class="op">)</span>
<span class="va">gap_id</span></code></pre></div>
<p>Since we generally call <code><a href="../../reference/as_sheets_id.html">as_sheets_id()</a></code> on whatever the user provides as <code>ss</code>, you can even pass <code>gap_dribble</code> straight into googlesheets4 functions.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sheet_properties.html">sheet_properties</a></span><span class="op">(</span><span class="va">gap_dribble</span><span class="op">)</span></code></pre></div>
<p>Two important things to note:</p>
<ul>
<li>googledrive requires auth for functions like <code><a href="https://googledrive.tidyverse.org/reference/drive_get.html">drive_get()</a></code> and <code><a href="https://googledrive.tidyverse.org/reference/drive_find.html">drive_find()</a></code> (see below). At first, you can just react to the interactive auth prompts and <strong>make sure you auth as the same user</strong> with googledrive and googlesheets4. Once you get tired of doing auth for both packages, read the article <a href="https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html">Using googlesheets4 with googledrive</a>. Coordinated auth should get even easier in the future.
<ul>
<li>In our hidden auth here, we have taken special measures to use a shared token for googledrive and googlesheets4.</li>
</ul>
</li>
<li>Remember to use <code><a href="https://googledrive.tidyverse.org/reference/drive_get.html">drive_get()</a></code> on a Sheet name <strong>that you have</strong>. If you don’t have a Sheet named “gapminder”, the code above won’t yield anything. As a rough rule of thumb, if you don’t see it at <a href="http://spreadsheets.google.com">spreadsheets.google.com</a>, you can’t <code><a href="https://googledrive.tidyverse.org/reference/drive_get.html">drive_get()</a></code> it either.</li>
</ul>
</div>
<div id="list-your-sheets-uses-googledrive" class="section level2">
<h2 class="hasAnchor">
<a href="#list-your-sheets-uses-googledrive" class="anchor"></a>List your Sheets (uses googledrive)</h2>
<p>What if you want to see all of your Sheets? Or all the Sheets with “gap” in their name?</p>
<p><code><a href="https://googledrive.tidyverse.org/reference/drive_find.html">googledrive::drive_find()</a></code> is the workhorse function for these tasks for general Drive files. It has lots of bells and whistles and we can use one of them to narrow the search to Google Sheets:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://googledrive.tidyverse.org/reference/drive_find.html">drive_find</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"spreadsheet"</span><span class="op">)</span></code></pre></div>
<p>This is so handy that we’ve made <code><a href="../../reference/gs4_find.html">gs4_find()</a></code> in googlesheets4, which is a shortcut for <code><a href="https://googledrive.tidyverse.org/reference/drive_find.html">drive_find(type = "spreadsheet")</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/gs4_find.html">gs4_find</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>See the examples for <code><a href="https://googledrive.tidyverse.org/reference/drive_find.html">drive_find()</a></code> and <code><a href="../../reference/gs4_find.html">gs4_find()</a></code> for more ideas about how to search Drive effectively for your Sheets.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p>googlesheets4 is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by <a href="https://jennybryan.org">Jennifer Bryan</a>, <a href="https://www.rstudio.com"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" height="24"></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
